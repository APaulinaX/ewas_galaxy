<tool id="minfi_read450k" name="Minfi Read 450k" version="2.1.0">
    <description>load .IDAT files</description>
    <requirements>
        <requirement type="package" version="1.24.0">bioconductor-minfi</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
      #for $counter, $input in enumerate($files_red):
        #set $redname = str( getattr( $input, 'element_identifier', 'sample' ) ).replace( "/", '-' ).replace( "\t", "-" )
        ln -s $input ./${redname} &&
      #end for
      #for $counter, $input in enumerate($files_grn):
        #set $grnname = str( getattr( $input, 'element_identifier', 'sample' ) ).replace( "/", '-' ).replace( "\t", "-" )
        ln -s $input ./${grnname} &&
      #end for
      Rscript '$read_idat_script'
      ]]></command>
      <configfiles>
      <configfile name="read_idat_script"><![CDATA[
        require("minfi", quietly = TRUE)
        out <- read.metharray(list.files(pattern="_Red.idat"))
        save(out, file = '$RGChannelSet')
        ]]> </configfile>
        </configfiles>
        <inputs>
        <param type="data" name="files_red" multiple="true" format="idat" label="Red .IDAT files"/>
          <param type="data" name="files_grn" multiple="true" format="idat" label="Green .IDAT files" />
            </inputs>
            <outputs>
            <data name="RGChannelSet" format="rdata" label="RGChannelSet"/>
              </outputs>
             <tests>
        <test>
            <param name="files_red" value="GSM1588707_8795207119_R06C02_Red.idat,GSM1588706_8795207135_R02C02_Red.idat,GSM1588705_8795207119_R05C02_Red.idat,GSM1588704_8795207135_R01C02_Red.idat" ftype="idat"/>
            <param name="files_grn" value="GSM1588707_8795207119_R06C02_Grn.idat,GSM1588706_8795207135_R02C02_Grn.idat,GSM1588705_8795207119_R05C02_Grn.idat,GSM1588704_8795207135_R01C02_Grn.idat" ftype="idat"/>
            <output name="RGChannelSet" file="RGChannelSet.rdata"/>
        </test>
    </tests>
    <help><![CDATA[

**What it does**

Minfi Read 450k is parsing binary 450K array IDAT files from Illumina Methylation Arrays.

**Input information**

Input data are IDAT files from Illumina Methylation Arrays including ending _Grn.idat or _Red.idat for each sample on the chip
intensity data. e.g. GSM1588707_8795207119_R06C02_Red.idat, GSM1588707_8795207119_R06C02_Grn.idat

**Output information**

Output is an object of R class RGChannelSet representing raw (unprocessed) data from Illumina Methylation Arrays i.e. used as an input in Minfi Mset Tool.

]]></help>
    <citations>
        <citation type="doi">10.18129/B9.bioc.illuminaio</citation>
</citations>
</tool>
